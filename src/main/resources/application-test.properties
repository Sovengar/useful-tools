# ═══════════════════════════════════════════════════════════════════════════════
# TEST PROFILE CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────────
# P6SPY - SQL Query Logging
# ─────────────────────────────────────────────────────────────────────────────────
# P6Spy wraps the JDBC driver to log all SQL queries
# Config: src/main/resources/spy.properties
spring.datasource.driver-class-name=com.p6spy.engine.spy.P6SpyDriver
spring.flyway.locations=classpath:db/migrations

# ─────────────────────────────────────────────────────────────────────────────────
# HIKARI CP - PERFORMANCE AND SHUTDOWN TUNING (IMPORTANT)
# ─────────────────────────────────────────────────────────────────────────────────
# NOTE: In a standard application with a single static container (Singleton), 
# these settings might not be necessary. 
# 
# HOWEVER, this project is a DEMO that uses multiple distinct Testcontainers setups 
# (InfraInitializer1, InfraInitializer3, DatabaseInitializer, etc.). 
# This results in multiple Spring Contexts and Hikari Pools running concurrently.
#
# When the JVM shuts down, Ryuk (Testcontainers) may kill the containers before 
# ALL Hikari pools have finished their cleanup. 
# Without these settings, multiple pools trying to validate connections against 
# a closed container will exceed Maven Surefire's 30s exit timeout.
# ─────────────────────────────────────────────────────────────────────────────────
spring.datasource.hikari.maximum-pool-size=2
spring.datasource.hikari.validation-timeout=1000
spring.datasource.hikari.connection-timeout=5000